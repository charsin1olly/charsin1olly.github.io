---
title: JAVA 數據類型的自動轉換
date: 2023-07-02 12:11:50
tags: [JAVA, 尚硅谷, 讀書筆記]
---
## 基本：範圍小的類型會自動提升為數據範圍大的類型
**範圍由小到大：byte < short < int < long < float < double**
    
float的範圍是3.4e−038～3.4e+038比long的-9,223,372,036,854,775,808～9,223,372,036,854,775,807還廣，所以long可以被轉換成float，但float不能轉換成long
```java
    int intOne = 1;
    
    long longOne = intOne;
    System.out.println("這是longOne ->"+longOne);
    //印出 這是longOne ->1

    long longTwo = 222;
    float floatTwo = longTwo;
    System.out.println("這是floatTwo ->"+floatTwo);
    // 印出 這是floatTwo ->222.0
```
如果想把float轉成long就會產生錯誤訊息 ：cannot convert from float to long
```java
    float floatThree = 2.01f;
    long longThree = floatThree;
    System.out.println("這是longThree ->"+longThree);
    System.out.println("這是floatThree ->"+floatThree);
```

## 特殊：byte、short和char的運算結果為int
byte和byte以及short和short之間運算的結果為int，這個設計是為了避免運算過程超出byte和short的數據範圍
```java
// 先寫一個可以檢查數據類型的方法
public static String getType(Object obj){
    return obj.getClass().toString();
  }

public static void main(String[] args){
    byte byteOne = 1;
    short shortOne = 2;
    char charOne = 'a';
    long longTwo = 222;
      
    System.out.println("byte相加的數據類型是："+getType(byteOne+byteOne));
    // byte相加的數據類型是：class java.lang.Integer
    
    System.out.println("short相加的數據類型是："+getType(shortOne+shortOne));
    // short相加的數據類型是：class java.lang.Integer
    
    System.out.println("char相加的數據類型是："+getType(charOne+charOne));
    // char相加的數據類型是：class java.lang.Integer
    
    System.out.println("byte+short的數據類型是："+getType(byteOne+shortOne));
    // byte+short的數據類型是：class java.lang.Integer
    
    System.out.println("char+byte相加的數據類型是："+getType(charOne+byteOne));
    // char+byte相加的數據類型是：class java.lang.Integer
    
    System.out.println("long相加的數據類型是："+getType(longTwo+longTwo));
    // long相加的數據類型是：class java.lang.Long
  }
```
## 特殊：不按照規則宣告變數的自動轉換
當宣告變數時不按照JAVA宣告變數，像是宣告long的時候沒有在數字後方加上L，則這個數據會被判斷為int，但因為int是可以轉換成
long的數據類型（int範圍小於long），所以編譯時不會報錯
```java
 public static void main(String[] args){
    long a = 123L;
    long b = 123; //此時的123判定為int
     
    System.out.println(getType(a));
     // 印出 class java.lang.Long
     
    System.out.println(getType(123));
     // 印出 class java.lang.Integer
     
    System.out.println(getType(b));
     // 印出class java.lang.Long
  }
  
```
同理如果是把範圍較大的double轉換成範圍較小的float，則會報錯
```java
public static void main(String[] args){
    float c = 123.01F;
    float d = 123.01; //此時的123.01判斷為double
    
    System.out.println(getType(c));
    System.out.println(getType(123.01));
    System.out.println(getType(d));
}

// 錯誤訊息 ：
// error: incompatible types: possible lossy conversion from double to float
```

## 數據運算的預設類型
整數運算後的預設數據類型為int、有小數的數據則為double
```java
public static void main(String[] args){
    byte b1 = 123;
    
    System.out.println(getType(b1+1));
    // 印出 class java.lang.Integer
    
    System.out.println(getType(b1+1.1));
    // 印出 class java.lang.Double
}
```
如果運算結果超過int範圍的話，結果則還是int類型(但答案會很奇怪):
```java
public static void main(String[] args){
    System.out.println(getType(b1+2147483647));
    System.out.println(b1+2147483647);
}

//class java.lang.Integer
// -2147483526
```
為了不產生奇怪的結果，則要使用Long，數據類型也會依照運算結果變成Long（）：
```java
public static void main(String[] args){
    System.out.println(getType(b1+2147483647L));
    System.out.println(b1+2147483647L);
}

// class java.lang.Long
// 2147483770
```

## 結論
JAVA數據類型是根據結果判斷的，如果兩種不同類型的數據進行運算，結果則會轉換為範圍大的數據類型；另外，運算結果會超出該數據類型的範圍，則會報錯或是產出不正確的答案，要謹慎選擇宣告類型。